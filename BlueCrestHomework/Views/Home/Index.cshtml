@{
    ViewData["Title"] = "Home Page";
}

@using System.Globalization
@model RequestBinding 

<div class="text-center">
    <div class="row">
        <form asp-controller="Home" asp-action="Index" method="post">
            <strong class="col-sm-3 align-text-middle">
                <img width="100" height="50" src="Images/bluecrest_logo.png"/>
            </strong>
            <strong class="col-sm-3 align-text-middle">Report: Pnl By Stategy</strong>
            <span class="col-sm-3 align-text-middle">Generated: 10/20/2021 12:10:43</span>
            <input onChange="this.form.submit()" type="checkbox" asp-for="ShowDetails" classs="col-sm-2" id="check_details"/>
            <label classs="col-sm-3" for="check_details"> Show Breakdown</label>
        </form>
    </div>
    @if (Model.TotalPnl < 0)
    {
        <h4 class="alert-danger">Total Pnl: ($@String.Format(CultureInfo.CurrentCulture, "{0:N2}", Math.Abs(Model.TotalPnl)))</h4>
    }
    else
    {
        <h4 class="alert-success">Total Pnl: $@String.Format(CultureInfo.CurrentCulture, "{0:N2}",  Model.TotalPnl))</h4>
    }
    <div class="row align-content-center">
        <table class="table-striped m-auto col-sm-12">
            @{
                var i = 0;
                foreach (var row in Model.Rows)
                {
                    if (i == 0)
                    {
                        <thead>
                        <tr>
                            <th>@nameof(row.Fund)</th>
                            <th>@nameof(row.Strategy)</th>
                            <th>@nameof(row.Desk)</th>
                            <th>Pnl ($)</th>
                            <th>Reported</th>
                            @if (Model.ShowDetails)
                            {
                                <th colspan="2">Breakdown</th>
                            }
                        </tr>
                        </thead>
                    }
                    else
                    {
                        <tr class="align-top">
                            <td class="text-left font-weight-bold">@row.Fund</td>
                            <td class="text-left">@row.Strategy</td>
                            <td class="text-left">@row.Desk</td>

                            @if (row.PnlReported)
                            {
                                @if (row.Pnl >= 0)
                                {
                                    <td class="text-right">@String.Format(CultureInfo.CurrentCulture, "{0:N2}", Math.Abs(row.Pnl))</td>
                                }
                                else
                                {
                                    <td class="text-right alert-danger">(@String.Format(CultureInfo.CurrentCulture, "{0:N2}", Math.Abs(row.Pnl)))</td>
                                }
                                <td>
                                    <img width="30" height="30" class="img-thumbnail small" src="Images/small_tick.jpeg"/>
                                </td>
                                @if (Model.ShowDetails)
                                {
                                    <td>
                                        <div class="row">
                                            @foreach (var details in row.PnlSubComponents)
                                            {
                                                <span class="col-6 text-sm-right">@details.Key</span>
                                                @if (details.Value >= 0)
                                                {
                                                    <span class="col-6 text-sm-right">@String.Format(CultureInfo.CurrentCulture, "{0:N2}", Math.Abs(details.Value))</span>
                                                }
                                                else
                                                {
                                                    <span class="col-6 text-sm-right alert-danger">(@String.Format(CultureInfo.CurrentCulture, "{0:N2}", Math.Abs(details.Value)))</span>
                                                }
                                            }
                                        </div>
                                    </td>
                                }
                            }
                            else
                            {
                                <td class="text-right">N/A</td>
                                <td></td>
                                <td></td>
                            }
                        </tr>
                    }
                    i++;
                }
            }
        </table>
    </div>

</div>